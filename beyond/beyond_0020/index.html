<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Csaba Fitzl">
    
    

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Beyond the good ol&#39; LaunchAgents - 20 - Terminal Preferences"/>
<meta name="twitter:description" content="This is part 20 in the series of &ldquo;Beyond the good ol&rsquo; LaunchAgents&rdquo;, where I try to collect various persistence techniques for macOS. For more background check the introduction.
This is another application specific persistence method, related to the Terminal application.
In the Terminal Preferences, under the Profiles tab, we can set a command that will be executed upon Terminal&rsquo;s startup. This is shown in the screen below.
This is stored inside Terminal&rsquo;s preferences PLIST file, located at ~/Library/Preferences/com."/>

    <meta property="og:title" content="Beyond the good ol&#39; LaunchAgents - 20 - Terminal Preferences" />
<meta property="og:description" content="This is part 20 in the series of &ldquo;Beyond the good ol&rsquo; LaunchAgents&rdquo;, where I try to collect various persistence techniques for macOS. For more background check the introduction.
This is another application specific persistence method, related to the Terminal application.
In the Terminal Preferences, under the Profiles tab, we can set a command that will be executed upon Terminal&rsquo;s startup. This is shown in the screen below.
This is stored inside Terminal&rsquo;s preferences PLIST file, located at ~/Library/Preferences/com." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://theevilbit.github.io/beyond/beyond_0020/" /><meta property="article:section" content="beyond" />
<meta property="article:published_time" content="2021-09-22T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-09-22T00:00:00+00:00" />



    
      <base href="https://theevilbit.github.io/beyond/beyond_0020/">
    
    <title>
  Beyond the good ol&#39; LaunchAgents - 20 - Terminal Preferences · theevilbit blog
</title>

    
      <link rel="canonical" href="https://theevilbit.github.io/beyond/beyond_0020/">
    

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="https://theevilbit.github.io/css/coder.min.28d751104f30c16da1aa1bb04015cbe662cacfe0d1b01af4f2240ad58580069c.css" integrity="sha256-KNdREE8wwW2hqhuwQBXL5mLKz&#43;DRsBr08iQK1YWABpw=" crossorigin="anonymous" media="screen" />
    

    

    

    

    
    
    <link rel="icon" type="image/png" href="https://theevilbit.github.io/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://theevilbit.github.io/images/favicon-16x16.png" sizes="16x16">

    <meta name="generator" content="Hugo 0.105.0">
  </head>

  <body class=" ">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="https://theevilbit.github.io/">
      theevilbit blog
    </a>
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://theevilbit.github.io/posts/">Posts</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://theevilbit.github.io/shield/">Shield.app</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://theevilbit.github.io/beyond/">Beyond good ol&#39; LaunchAgents</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://theevilbit.github.io/tags/">Tags</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://theevilbit.github.io/categories/">Categories</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://theevilbit.github.io/about/">About</a>
          </li>
        
      
      
    </ul>
  </section>
</nav>


      <div class="content">
        
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">Beyond the good ol&#39; LaunchAgents - 20 - Terminal Preferences</h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fas fa-calendar"></i>
              <time datetime='2021-09-22T00:00:00Z'>
                September 22, 2021
              </time>
            </span>
            <span class="reading-time">
              <i class="fas fa-clock"></i>
              2 minutes read
            </span>
          </div>
          <div class="categories">
  <i class="fas fa-folder"></i>
    <a href="https://theevilbit.github.io/categories/persistence/">persistence</a>
      <span class="separator">•</span>
    <a href="https://theevilbit.github.io/categories/beyond/">beyond</a></div>

          <div class="tags">
  <i class="fas fa-tag"></i>
    <a href="https://theevilbit.github.io/tags/macos/">macos</a>
      <span class="separator">•</span>
    <a href="https://theevilbit.github.io/tags/persistence/">persistence</a>
      <span class="separator">•</span>
    <a href="https://theevilbit.github.io/tags/beyond/">beyond</a></div>

        </div>
      </header>

      <div>
        <blockquote>
<p>This is part 20 in the series of &ldquo;Beyond the good ol&rsquo; LaunchAgents&rdquo;, where I try to collect various persistence techniques for macOS. For more background check the <a href="https://theevilbit.github.io/beyond/beyond_intro/">introduction</a>.</p>
</blockquote>
<p>This is another application specific persistence method, related to the Terminal application.</p>
<p>In the Terminal Preferences, under the Profiles tab, we can set a command that will be executed upon Terminal&rsquo;s startup. This is shown in the screen below.</p>
<p><img src="https://theevilbit.github.io/images/beyond/beyond_0020_0.png" alt="Terminal Profile Settings"></p>
<p>This is stored inside Terminal&rsquo;s preferences PLIST file, located at  <code>~/Library/Preferences/com.apple.Terminal.plist</code>. Normally this is a binary PLIST, and thus we can use <code>plutil</code> to display it in a human readable form.</p>
<pre tabindex="0"><code>csaby@mac Preferences % plutil -p com.apple.Terminal.plist| less
{
  &#34;Default Window Settings&#34; =&gt; &#34;Basic&#34;
  &#34;DefaultProfilesVersion&#34; =&gt; 1
  &#34;HasMigratedDefaults&#34; =&gt; 1
  &#34;Man Page Window Settings&#34; =&gt; &#34;Man Page&#34;
  &#34;NSNavLastRootDirectory&#34; =&gt; &#34;~/Documents&#34;
  &#34;NSNavLastUserSetHideExtensionButtonState&#34; =&gt; 0
  &#34;NSWindow Frame NSNavPanelAutosaveName&#34; =&gt; &#34;732 711 328 167 0 0 1792 1095 &#34;
  &#34;NSWindow Frame TTAppPreferences&#34; =&gt; &#34;563 437 668 554 0 0 1792 1095 &#34;
  &#34;NSWindow Frame TTWindow&#34; =&gt; &#34;132 206 1522 805 0 0 1792 1095 &#34;
  &#34;NSWindow Frame TTWindow Basic&#34; =&gt; &#34;132 178 1522 833 0 0 1792 1095 &#34;
  &#34;NSWindow Frame TTWindow Man Page&#34; =&gt; &#34;59 152 570 707 0 0 1792 1095 &#34;
  &#34;NSWindow Frame TTWindow test&#34; =&gt; &#34;61 555 934 561 0 0 1920 1177 &#34;
  &#34;NSWindow Frame TTWindow test 1&#34; =&gt; &#34;76 310 585 365 0 0 1792 1097 &#34;
  &#34;ProfileCurrentVersion&#34; =&gt; 2.07
  &#34;SecureKeyboardEntry&#34; =&gt; 0
  &#34;Shell&#34; =&gt; &#34;&#34;
  &#34;Startup Window Settings&#34; =&gt; &#34;Basic&#34;
  &#34;TTAppPreferences Selected Tab&#34; =&gt; 1
  &#34;Window Settings&#34; =&gt; {
    &#34;Basic&#34; =&gt; {
      &#34;CommandString&#34; =&gt; &#34;touch /Users/Shared/executed.txt;&#34;
...
</code></pre><p>As we can see above, the setting is stored under the &ldquo;Window Settings&rdquo; -&gt; Basic (which is the name of the profile) -&gt; &ldquo;CommandString&rdquo;. The Startup profile is set under &ldquo;Startup Window Settings&rdquo;. Which is important, because the command associated with the Startup profile will be executed.</p>
<p>In XML it looks like the following:</p>
<pre tabindex="0"><code>csaby@mac Preferences % plutil -convert xml1 com.apple.Terminal.plist -o -| less 
...
        &lt;key&gt;Startup Window Settings&lt;/key&gt;
        &lt;string&gt;Basic&lt;/string&gt;
...
        &lt;key&gt;Window Settings&lt;/key&gt;
        &lt;dict&gt;
                &lt;key&gt;Basic&lt;/key&gt;
                &lt;dict&gt;
                        &lt;key&gt;CommandString&lt;/key&gt;
                        &lt;string&gt;touch /Users/Shared/executed.txt;&lt;/string&gt;
...
</code></pre><p>If we are not sandboxed, we can write to this file, and whenever a user starts Terminal our command will be executed.</p>

      </div>

      <footer>
        


        
      </footer>
    </article>

    
  </section>

      </div>

      <footer class="footer">
  <section class="container">
    
     © 2022
    
       · 
      Blog created by <a href="https://twitter.com/theevilbit">@theevilbit</a>.
    
    
  </section>
</footer>

    </main>

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-151008930-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

  </body>

</html>
